<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>小小博客</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet"/>
 <link rel="stylesheet" href="../css/cropper.min.css">
    <link rel="stylesheet" href="../css/ImgCropping.css">
    <link rel="stylesheet" href="../style/global.css">
</head>

<body>
<div class="content">
    <div class="header">
        <nav class="navbar navbar-inverse">
            <div class="container-fluid">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                            data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <b class="navbar-brand">小小博客</b>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="#">网站首页 <span class="sr-only">(current)</span></a></li>
                        <li><a href="#">我的相册</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-haspopup="true" aria-expanded="false">更多 <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <li><a href="#">Action</a></li>
                                <li><a href="#">Another action</a></li>
                                <li><a href="#">Something else here</a></li>
                                <li role="separator" class="divider"></li>
                                <li><a href="#">Separated link</a></li>
                                <li role="separator" class="divider"></li>
                                <li><a href="#">One more separated link</a></li>
                            </ul>
                        </li>
                    </ul>
                    <form class="navbar-form navbar-left">
                        <div class="form-group">
                            <input type="text" class="form-control mini" placeholder="输入关键字搜索">
                        </div>
                        <button type="submit" class="btn btn-default">搜索</button>
                    </form>
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="#"><span class="glyphicon glyphicon-bell" aria-hidden="true"></span></a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-haspopup="true" aria-expanded="false">登录 <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <form class="navbar-form navbar-left" role="search">
                                    <div class="form-group">
                                        <input type="text" class="form-control form-username" id="userName" name="userName" placeholder="用户名">
                                        <input type="text" class="form-control form-password" id="password" name="password" placeholder="密码">
                                    </div>
                                    <button type="button" class="btn btn-success form-btn submit-btn">登录</button>
                                    <a href="/views/regist.html">
                                        <button type="button" class="btn btn-warning form-btn">注册</button>
                                    </a>
                                </form>
                            </ul>
                        </li>

                    </ul>
                </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->
        </nav>
    </div>


    <div class="row row-wrap">
        <div class="col-md-3 row-left">
            <div class="row head-wrap">
                <div class="col-sm-6 col-md-8">
                    <div class="thumbnail">

                        <!-- <img src="../images/head.jpeg" alt="..."> -->
                       
                        <div style="width: 160px;height:160px;" id="replaceImg">
                            <img id="finalImg" src="../images/head.jpeg" width="100%">

                        </div>
                        <div style="display: none" class="tailoring-container">
                            <div class="black-cloth" onclick="closeTailor(this)"></div>
                            <div class="tailoring-content">
                                    <div class="tailoring-content-one">
                                        <label title="上传图片" for="chooseImg" class="l-btn choose-btn">
                                            <input type="file" accept="image/jpg,image/jpeg,image/png" name="file" id="chooseImg" class="hidden" onchange="selectImg(this)">
                                            选择图片
                                        </label>
                                        <div class="close-tailoring"  onclick="closeTailor(this)">×</div>
                                    </div>
                                    <div class="tailoring-content-two">
                                        <div class="tailoring-box-parcel">
                                            <img id="tailoringImg">
                                        </div>
                                        <div class="preview-box-parcel">
                                            <p>图片预览：</p>
                                            <div class="square previewImg"></div>
                                            <div class="circular previewImg"></div>
                                        </div>
                                    </div>
                                    <div class="tailoring-content-three">
                                        <button class="l-btn cropper-reset-btn">复位</button>
                                        <button class="l-btn cropper-rotate-btn">旋转</button>
                                        <button class="l-btn cropper-scaleX-btn">换向</button>
                                        <button class="l-btn sureCut" id="sureCut">确定</button>
                                    </div>
                                </div>
                        </div>

                         <!-- <button id="replaceImg" class="l-btn">更换图片</button> -->
                        <h4 class="head-title">我要个性网QQ头像频道的QQ男生头像栏目,带字、超拽等各种帅气男生头像一应俱全。</h4>

                    </div>
                </div>
            </div>
            <ul class="list-group">
                <li class="list-group-item">Cras justo odio</li>
                <li class="list-group-item">Dapibus ac facilisis in</li>
                <li class="list-group-item">Morbi leo risus</li>
                <li class="list-group-item">Porta ac consectetur ac</li>
                <li class="list-group-item">Vestibulum at eros</li>
            </ul>
            <form class="form-horizontal col-lg-12">
                <div class="form-group">
                    <label for="userName" class="col-sm-3 control-label">姓名</label>

                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="name" name="name" placeholder="姓名">
                    </div>
                </div>
                <div class="form-group">
                    <label for="title" class="col-sm-3 control-label">标题</label>

                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="title" name="title" placeholder="标题">
                    </div>
                </div>
                <div class="form-group">
                    <label for="content" class="col-sm-3 control-label">留言</label>

                    <div class="col-sm-10">
                        <textarea class="form-control" rows="3" name="content" id="usercontent"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-sm-offset-3 col-sm-10">
                        <button id="addMsg" type="button" class="btn btn-success">提交</button>
                    </div>
                </div>
                <div class="alert alert-success" role="alert" id="chenggong">
                    <a href="#" class="alert-link">表单已经成功提交</a>
                </div>
                <div class="alert alert-danger" role="alert" id="shibai">
                    <a href="#" class="alert-link">表单提交失败</a>
                </div>
            </form>


        </div>
        <div class="col-md-6">
            <div id="myCarousel" class="carousel slide">
                <!-- 轮播（Carousel）指标 -->
                <ol class="carousel-indicators">
                    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                    <li data-target="#myCarousel" data-slide-to="1"></li>
                    <li data-target="#myCarousel" data-slide-to="2"></li>
                </ol>
                <!-- 轮播（Carousel）项目 -->
                <div class="carousel-inner">
                    <div class="item active">
                        <img src="../images/flisder.jpg" alt="First slide">
                    </div>
                    <div class="item">
                        <img src="../images/flisder.jpg" alt="Second slide">
                    </div>
                    <div class="item">
                        <img src="../images/flisder.jpg" alt="Third slide">
                    </div>
                </div>
                <!-- 轮播（Carousel）导航 -->
                <a class="carousel-control left" href="#myCarousel"
                   data-slide="prev">
                    <span _ngcontent-c3="" aria-hidden="true" class="glyphicon glyphicon-chevron-left"></span></a>
                <a class="carousel-control right" href="#myCarousel"
                   data-slide="next">
                    <span _ngcontent-c3="" aria-hidden="true" class="glyphicon glyphicon-chevron-right"></span>
                </a>
            </div>
            <div class="group-title" id="content-wrap">
                <!--   <div class="list-group ">
                    <a href="#" class="list-group-item list-group-item-info">
                    <h4 class="list-group-item-heading">我们是同学</h4>
                    <p class="list-group-item-text text">我认识了你。我们是同学，彼此都还不熟悉的同学。那一句个子还高嘛，是我关注你的开始，有意无意的从四组向一组瞟你，小心翼翼的眼神怕你发现，却又怕你不明白，一点点的喜欢不敢声张。后来的打过来骂过去，后来聊天的默契，互道的晚安，才明白原来就是喜欢，没有其他。确定</p>
                     <p><span class="glyphicon glyphicon-user icon" aria-hidden="true">刘大大</span>

                        <span class="glyphicon glyphicon-time icon" aria-hidden="true">2018-6-21</span>

                        <span class="glyphicon glyphicon-pencil icon" aria-hidden="true">5841条评论</span>

                     </p>
                    </a>
                </div> -->

            </div>

            <nav aria-label="" class="footer" id="footer">
                <!--   <ul class="pagination">
                    <li class="disabled">
                      <a href="#" aria-label="Previous">
                      <span aria-hidden="true">&laquo;</span>
                    </a>
                    </li>
                    <li class="active"><a href="#">1 <span class="sr-only">(current)</span></a></li>
                     <li><a href="#">1 <span class="sr-only">(current)</span></a></li>
                      <li><a href="#">2 <span class="sr-only">(current)</span></a></li>
                       <li><a href="#">3 <span class="sr-only">(current)</span></a></li>
                        <li><a href="#">4 <span class="sr-only">(current)</span></a></li>
                        <li>
                       <a href="#" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                      </a>
                    </li>
                  </ul> -->
            </nav>


        </div>
        <div class="col-md-3">
            <div class="media">
                <div class="media-left">
                    <a href="#">
                        <img class="media-object img" src="../images/head.jpeg" alt="...">
                    </a>
                </div>
                <div class="media-body">
                    <h4 class="media-heading">Media heading</h4>
                    却又怕你不明白，一点点的喜欢不敢声张。后来的打过来骂
                </div>
            </div>


        </div>
    </div>


</div>


</body>
<script type="text/template" id="content">

    <div class="list-group ">
        <div href="#" class="list-group-item list-group-item-info">
            <h4 class="list-group-item-heading"><%= title%></h4>
            <p class="list-group-item-text text"><%= content%></p>
            <p><span class="glyphicon glyphicon-user icon" aria-hidden="true"><%= name%></span>

                <span class="glyphicon glyphicon-time icon" aria-hidden="true"><%= time%></span>
                <span class="glyphicon glyphicon-pencil icon" aria-hidden="true"><%= look%>条评论</span>
                <a href="/delete?id=<%= id%>" class="label label-danger delete">删除</a>

            </p>

        </div>
    </div>


</script>

<script type="text/template" id="page">


    <ul class="pagination">
        <li class="page-option" data-page="odd">
            <a href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
        <% _.each(obj,function(e,i,a){%>
        <%if(i==0){%>
        <li class="active page-option" data-page="<%=i+1%>"><a href="#"><%= i+1%><span class="sr-only">(current)</span></a>
        </li>
        <%}else{%>
        <li class="page-option" data-page="<%=i+1%>"><a><%= i+1%><span class="sr-only">(current)</span></a></li>
        <%}%>

        <%})%>
        <li class="page-option" data-page="add">
            <a href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
    </ul>

</script>


<script src="../js/jquery-1.11.3.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script type="text/javascript" src="../js/underscore-noflect.js"></script>
<script src="../js/cropper.min.js"></script>
<script src="../javaScript/index.js"></script>
<script>

    //弹出框水平垂直居中
    (window.onresize = function () {
        var win_height = $(window).height();
        var win_width = $(window).width();
        if (win_width <= 768){
            $(".tailoring-content").css({
                "top": (win_height - $(".tailoring-content").outerHeight())/2,
                "left": 0
            });
        }else{
            $(".tailoring-content").css({
                "top": (win_height - $(".tailoring-content").outerHeight())/2,
                "left": (win_width - $(".tailoring-content").outerWidth())/2
            });
        }
    })();

    //弹出图片裁剪框
    $("#replaceImg").on("click",function () {
        $(".tailoring-container").toggle();
    });
    //图像上传
    function selectImg(file) {

        console.log(file);
        // if (!file.files || !file.files[0]){
        //     return;
        // }
        var reader = new FileReader();
        reader.onload = function (evt) {
            console.log(evt);
            var replaceSrc = evt.target.result;

            $.post("/dosetavatar",{
               "base64url":replaceSrc,
        
            },function(result){

                if(result.success){

                  module.initGetMsg();
                  module.initPageOption();

                }

            })


            //更换cropper的图片
            $('#tailoringImg').cropper('replace', replaceSrc,false);//默认false，适应高度，不失真
        }
        reader.readAsDataURL(file.files[0]);
    }
    //cropper图片裁剪
    $('#tailoringImg').cropper({
        aspectRatio: 1/1,//默认比例
        preview: '.previewImg',//预览视图
        guides: false,  //裁剪框的虚线(九宫格)
        autoCropArea: 0.5,  //0-1之间的数值，定义自动剪裁区域的大小，默认0.8
        movable: false, //是否允许移动图片
        dragCrop: true,  //是否允许移除当前的剪裁框，并通过拖动来新建一个剪裁框区域
        movable: true,  //是否允许移动剪裁框
        resizable: true,  //是否允许改变裁剪框的大小
        zoomable: false,  //是否允许缩放图片大小
        mouseWheelZoom: false,  //是否允许通过鼠标滚轮来缩放图片
        touchDragZoom: true,  //是否允许通过触摸移动来缩放图片
        rotatable: true,  //是否允许旋转图片
        crop: function(e) {
            // 输出结果数据裁剪图像。
        }
    });
    //旋转
    $(".cropper-rotate-btn").on("click",function () {
        $('#tailoringImg').cropper("rotate", 45);
    });
    //复位
    $(".cropper-reset-btn").on("click",function () {
        $('#tailoringImg').cropper("reset");
    });
    //换向
    var flagX = true;
    $(".cropper-scaleX-btn").on("click",function () {
        if(flagX){
            $('#tailoringImg').cropper("scaleX", -1);
            flagX = false;
        }else{
            $('#tailoringImg').cropper("scaleX", 1);
            flagX = true;
        }
        flagX != flagX;
    });

    //裁剪后的处理
    $("#sureCut").on("click",function () {
        if ($("#tailoringImg").attr("src") == null ){
            return false;
        }else{
            var cas = $('#tailoringImg').cropper('getCroppedCanvas');//获取被裁剪后的canvas
            var base64url = cas.toDataURL('image/png'); //转换为base64地址形式
            $("#finalImg").prop("src",base64url);//显示为图片的形式

            //关闭裁剪框
            closeTailor();
        }
    });
    //关闭裁剪框
    function closeTailor() {
        $(".tailoring-container").toggle();
    }



</script>
